<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Static Graph</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div id="controls">
        <input type="file" id="upload" />
        <button id="displaySizes">Display Sizes</button>
    </div>
    <svg width="960" height="600"></svg>

    <script>
        document.getElementById('upload').addEventListener('change', handleFileSelect, false);
        document.getElementById('displaySizes').addEventListener('click', displaySizes);

        let graphData;

        function handleFileSelect(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                graphData = JSON.parse(e.target.result);
                renderGraph(graphData);
            };
            reader.readAsText(file);
        }

        function renderGraph(data) {
            const svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            svg.selectAll("*").remove();

            const link = svg.append("g")
                .selectAll("line")
                .data(data.edges)
                .enter().append("line")
                .attr("class", "link")
                .attr("stroke", d => d.color)
                .attr("stroke-width", d => d.strokeWidth)
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            const node = svg.append("g")
                .selectAll("circle")
                .data(data.nodes)
                .enter().append("circle")
                .attr("class", "node")
                .attr("r", d => d.size)
                .attr("fill", d => d.fillColor)
                .attr("cx", d => d.x)
                .attr("cy", d => d.y);

            node.append("title")
                .text(d => d.id);
        }

        function displaySizes() {
            const svg = d3.select("svg");
            svg.selectAll("text").remove(); // Remove any existing size labels

            svg.selectAll("circle")
                .data(graphData.nodes)
                .append("text")
                .attr("x", d => d.x + 5)
                .attr("y", d => d.y + 5)
                .text(d => d.size)
                .attr("font-size", "10px")
                .attr("fill", "black");
        }
    </script>
</body>
</html>